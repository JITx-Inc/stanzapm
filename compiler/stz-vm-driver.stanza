defpackage stz/vm-driver :
  import core
  import collections
  import stz/vm-ir
  import stz/vm
  import stz/vm-analyze

defn main () :
  val filename = command-line-arguments()[1]
  val prog = read-vm-prog(filename)
  
  println("===== Input Program =====")
  println(prog)

  println("===== Analyze Program =====")
  analyze(prog)

  val trace? = contains?(command-line-arguments(), "-trace")
  interpret(prog, trace?)

main()